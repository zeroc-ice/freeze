# C++98 Demos

- [Overview](#overview)
- [Building and Running the Demos on Linux and macOS](#building-and-running-the-demos-on-linux-and-macos)
- [Building and Running the Demos on Windows](#building-and-running-the-demos-on-windows)

## Overview

This directory contains C++ sample programs for Freeze. It includes the
following subdirectories:

- [Freeze](./Freeze) contains Freeze examples for using the Freeze library.

- [Manual](./Manual) contains complete examples for some of the code snippets
in the [Freeze Manual][1].

## Building and Running the Demos on Linux and macOS

### Prerequisites

The makefiles require GNU make 3.80 or later.

On macOS, the command-line demos require the Xcode Command Line Tools to be
installed (use `xcode-select --install` to install them).

If you've installed Ice or Freeze in a non-standard location, you'll need to set
the `ICE_HOME` or `FREEZE_HOME` environment variable with the path name of the
installation directory:

```
export ICE_HOME=/opt/Ice-3.7.10
export FREEZE_HOME=/opt/Freeze-3.7.10
```

### Building the Demos

Review the settings in `make/Make.rules`. For example, set `OPTIMIZE=yes`
to build with optimization.

When you're ready to start the build, run `make`, for example:
```
make V=1
```

`V=1` in the example above turns on verbose output.

The `clean` and `distclean` targets allow you clean all the demos. `clean`
removes the binary files created by the build; `distclean` removes all these
files plus the C++ files generated by slice2cpp or slice2freeze.

You can also build or clean a single demo with `make <demo-path>[_clean|_distclean]`,
for example:
```
make V=1 Freeze/library
make Freeze/library_distclean
```

### Running the Demos

Refer to the README.md file in each demo directory for usage instructions.

## Building and Running the Demos on Windows

### Prerequisites

The projects for the sample programs require the [Ice Builder for Visual Studio][2].
Add this extension to Visual Studio before opening the solution.

### Building the Demos

#### Building the demos using NuGet packages

Open the solution file `Freeze C++ demos.sln` to build the sample programs.

The demos are configured to use Ice and Freeze C++ binary distributions,
packaged with NuGet. The build automatically downloads the Ice and Freeze NuGet
packages.

If you have disabled the automatic download of NuGet packages by Visual Studio,
you need to restore the packages before you build using `Tools > NuGet Package
Manager > Manage NuGet Packages for Solution...` in Visual Studio.

Then select your target configuration (Debug or Release) and platform (Win32
or x64). Right click on the desired demo in the Solution Explorer window and
select `Build`.

#### Building the demos using a source build

- Build from command line:
  * Open a Visual Studio command prompt
  ```
  cd freeze\cpp\cpp98
  MSBuild /p:ICE_HOME=<Ice dist path> /p:FREEZE_HOME=<Freeze dist path> /p:Configuration=<Release or Debug> "Freeze C++ demos.sln"
  ```

- Build from Visual Studio
  * Open a Visual Studio command prompt
  ```
  set ICE_HOME=<Ice dist path>
  set FREEZE_HOME=<Freeze dist path>
  devenv
  ```

  * Disable automatic restoring of NuGet packages in Visual Studio
    `Tools > Options > NuGet Package Manager`
  * Select your target configuration (Debug or Release) and platform (Win32 or
    x64). Right click on the desired demo in the Solution Explorer window and
    select `Build`.

### Running the Demos

You need to add the Ice and Freeze `bin` directory to your PATH before running
the demos, with a command similar to:
```
set PATH=%USERPROFILE%\freeze\demos\cpp98\packages\zeroc.ice.v140.3.7.10\build\native\bin\x64\Release;%PATH%
set PATH=%USERPROFILE%\freeze\demos\cpp98\packages\zeroc.freeze.v140.3.7.10\build\native\bin\x64\Release;%PATH%
```

Then refer to the README.md file in each demo directory for usage instructions.

[1]: https://doc.zeroc.com/freeze/3.7/freeze-manual
[2]: https://github.com/zeroc-ice/ice-builder-visualstudio
